import{u as X,a as W,n as Z,v as ee,b as te,m as le,l as re,c as ae,y as se,h as ne,d as oe,e as ue,L as ie,H as ce,f as ve,r as D}from"./app-d4c0b620.js";import{c as de,u as fe,ab as he,r as m,h as A,z as j,o as pe,I as ye,j as a,a5 as Q,K as me,i as ge}from"./framework-8980b429.js";function we(l){if(Array.isArray(l)){for(var e=0,t=Array(l.length);e<l.length;e++)t[e]=l[e];return t}else return Array.from(l)}var P=!1;if(typeof window<"u"){var Y={get passive(){P=!0}};window.addEventListener("testPassive",null,Y),window.removeEventListener("testPassive",null,Y)}var U=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),h=[],b=!1,B=-1,g=void 0,w=void 0,_=function(e){return h.some(function(t){return!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))})},R=function(e){var t=e||window.event;return _(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},Se=function(e){if(w===void 0){var t=!!e&&e.reserveScrollBarGap===!0,o=window.innerWidth-document.documentElement.clientWidth;t&&o>0&&(w=document.body.style.paddingRight,document.body.style.paddingRight=o+"px")}g===void 0&&(g=document.body.style.overflow,document.body.style.overflow="hidden")},be=function(){w!==void 0&&(document.body.style.paddingRight=w,w=void 0),g!==void 0&&(document.body.style.overflow=g,g=void 0)},Re=function(e){return e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1},He=function(e,t){var o=e.targetTouches[0].clientY-B;return _(e.target)?!1:t&&t.scrollTop===0&&o>0||Re(t)&&o<0?R(e):(e.stopPropagation(),!0)},Le=function(e,t){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!h.some(function(n){return n.targetElement===e})){var o={targetElement:e,options:t||{}};h=[].concat(we(h),[o]),U?(e.ontouchstart=function(n){n.targetTouches.length===1&&(B=n.targetTouches[0].clientY)},e.ontouchmove=function(n){n.targetTouches.length===1&&He(n,e)},b||(document.addEventListener("touchmove",R,P?{passive:!1}:void 0),b=!0)):Se(t)}},Te=function(){U?(h.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),b&&(document.removeEventListener("touchmove",R,P?{passive:!1}:void 0),b=!1),B=-1):be(),h=[]};const ke="search-pro-result-history",v=X(ke,[]),$e=()=>{const{resultHistoryCount:l}=D,e=l>0;return{enabled:e,resultHistory:v,addResultHistory:t=>{e&&(v.value.length<l?v.value=[t,...v.value]:v.value=[t,...v.value.slice(0,l-1)])},removeResultHistory:t=>{v.value=[...v.value.slice(0,t),...v.value.slice(t+1)]}}},Ae=l=>{const e=W(),t=m(!1),o=m([]);let n;const d=ve(p=>{t.value=!0,n==null||n.terminate(),p?(n=new Worker(`/vuepress-python-notes/${D.worker}`,{}),n.addEventListener("message",({data:H})=>{o.value=H,t.value=!1}),n.postMessage({query:p,routeLocale:e.value})):(o.value=[],t.value=!1)},D.delay);return j([l,e],()=>d(l.value),{immediate:!0}),{searching:t,results:o}};var Be=de({name:"SearchResult",props:{query:{type:String,required:!0}},emits:["close","updateQuery"],setup(l,{emit:e}){const t=ue(),o=fe(),n=W(),d=Z(ee),{addQueryHistory:p}=ie(),{enabled:H,resultHistory:q,addResultHistory:C,removeResultHistory:z}=$e(),L=he(l,"query"),{results:y,searching:F}=Ae(L),i=m(0),u=m(0),M=m(),E=A(()=>q.value.length>0),T=A(()=>y.value.length>0),k=A(()=>y.value[i.value]||null),G=()=>{i.value=i.value>0?i.value-1:y.value.length-1,u.value=k.value.contents.length-1},K=()=>{i.value=i.value<y.value.length-1?i.value+1:0,u.value=0},V=()=>{u.value<k.value.contents.length-1?u.value=u.value+1:K()},J=()=>{u.value>0?u.value=u.value-1:G()},O=r=>r.map(s=>ge(s)?s:a(s[0],s[1])),x=r=>{if(r.type==="custom"){const s=ce[r.index]||"$content",[f,S=""]=me(s)?s[n.value].split("$content"):s.split("$content");return O([f,...r.display,S])}return O(r.display)},$=()=>{i.value=0,u.value=0,e("updateQuery",""),e("close")};return te("keydown",r=>{if(T.value){if(r.key==="ArrowUp")J();else if(r.key==="ArrowDown")V();else if(r.key==="Enter"){const s=k.value.contents[u.value];t.value.path!==s.path&&(p(l.query),C(s),o.push(s.path),$())}}}),j([i,u],()=>{var r;(r=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||r.scrollIntoView(!1)},{flush:"post"}),pe(()=>{Le(M.value,{reserveScrollBarGap:!0})}),ye(()=>{Te()}),()=>a("div",{class:["search-pro-result",{empty:L.value?!T.value:!E.value}],id:"search-pro-results",ref:M},L.value===""?E.value?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},d.value.history),q.value.map((r,s)=>a(Q,{to:r.path,class:["search-pro-result-item",{active:u.value===s}],onClick:()=>{$()}},()=>[a(le,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[r.type==="content"&&r.header?a("div",{class:"content-header"},r.header):null,a("div",x(r))]),a("button",{class:"search-pro-close-icon",onClick:f=>{f.preventDefault(),f.stopPropagation(),z(s)}},a(re))]))])):H?d.value.emptyHistory:d.value.emptyResult:F.value?a(ae,{hint:d.value.searching}):T.value?a("ul",{class:"search-pro-result-list"},y.value.map(({title:r,contents:s},f)=>{const S=i.value===f;return a("li",{class:["search-pro-result-list-item",{active:S}]},[a("div",{class:"search-pro-result-title"},r||"Documentation"),s.map((c,N)=>{const I=S&&u.value===N;return a(Q,{to:c.path,class:["search-pro-result-item",{active:I,"aria-selected":I}],onClick:()=>{p(l.query),C(c),$()}},()=>[c.type==="content"?null:a(c.type==="title"?se:c.type==="heading"?ne:oe,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[c.type==="content"&&c.header?a("div",{class:"content-header"},c.header):null,a("div",x(c))])])})])})):d.value.emptyResult)}});export{Be as default};
